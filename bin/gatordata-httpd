#!/usr/bin/env node

tools = require('../gator/script_tools.js');

MASCP = require('../gator/dist/js/maschup.services.js');
MASCP.events.once('ready',function() {
    MASCP.Service.BeginCaching();
    var http = require('http');
    http.createServer(function (req, res) {
        // Regexp check the AGI
        var agi = req.url.replace('/','');
        (new MASCP.TairReader()).retrieve(agi,function(err) {
            res.writeHead(200, {'Content-Type': 'text/plain'});
            res.end(this.result.getSequence());
        });
    }).listen(3000, "127.0.0.1");
    console.log('Server running at http://127.0.0.1:3000/');
});